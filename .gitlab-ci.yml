# ----------------------------------------------------------------------------#

image: python:latest

# ----------------------------------------------------------------------------#

stages:
  - test
  - deploy

# ----------------------------------------------------------------------------#

before_script:
  - pip install -r requirements.txt &&\
    pip install -r dev_requirements.txt

# ----------------------------------------------------------------------------#

include:
  - template: Jobs/Dependency-Scanning.gitlab-ci.yml
  - template: Jobs/SAST.gitlab-ci.yml
  - template: Jobs/Secret-Detection.gitlab-ci.yml

# ----------------------------------------------------------------------------#

lint:
  stage: test
  script:
    - flake8 .
  only:
    changes:
      - '*.py'
      - '**/*.py'

# ----------------------------------------------------------------------------#

sast:
  stage: test
  interruptible: true
  script:
    - []
  rules:
    - if: '$CI_PIPELINE_SOURCE == "merge_request_event"'
    - if: '$CI_PIPELINE_SOURCE == "schedule"'
